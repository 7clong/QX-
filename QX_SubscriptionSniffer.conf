#!name=QX · Subscription Sniffer (Study Only)
#!desc=通用订阅接口抓包：subscribers / receipts / offerings。仅记录，不修改。学习研究用。
#!author=QuantumultX 规则工程师
#!version=2025.08.25
#!homepage=https://github.com/7clong/QX-
#!icon=https://raw.githubusercontent.com/7clong/QX-/main/qx/icon/sniffer.png

# 说明：
# 1) 需要开启 MitM 并信任 QX 证书。多数 App 为 HTTPS，不开 MitM 你抓个空气。
# 2) hostname=* 为通配（尽可能广覆盖）。若你的 QX 版本不接受通配，请自行把目标域名加到“MitM 主机名”里。
# 3) 本模块只打印日志，不改包，不影响业务。

hostname = *

# ===== 订阅状态 =====
# Request
^https?:\/\/[^\/]+\/v1\/subscribers\/[^\/\?]+$ url script-request-body https://raw.githubusercontent.com/7clong/QX-/main/subs-sniffer.js, requires-body=true, timeout=15, tag=Sniffer · subscribers · req
# Response
^https?:\/\/[^\/]+\/v1\/subscribers\/[^\/\?]+$ url script-response-body https://raw.githubusercontent.com/7clong/QX-/main/subs-sniffer.js, requires-body=true, timeout=15, tag=Sniffer · subscribers · resp

# ===== 收据校验 =====
# Request
^https?:\/\/[^\/]+\/v1\/receipts(\?.*)?$ url script-request-body https://raw.githubusercontent.com/7clong/QX-/main/subs-sniffer.js, requires-body=true, timeout=15, tag=Sniffer · receipts · req
# Response
^https?:\/\/[^\/]+\/v1\/receipts(\?.*)?$ url script-response-body https://raw.githubusercontent.com/7clong/QX-/main/subs-sniffer.js, requires-body=true, timeout=15, tag=Sniffer · receipts · resp

# ===== 套餐列表 =====
# Request
^https?:\/\/[^\/]+\/v1\/offerings(\?.*)?$ url script-request-body https://raw.githubusercontent.com/7clong/QX-/main/subs-sniffer.js, requires-body=true, timeout=15, tag=Sniffer · offerings · req
# Response
^https?:\/\/[^\/]+\/v1\/offerings(\?.*)?$ url script-response-body https://raw.githubusercontent.com/7clong/QX-/main/subs-sniffer.js, requires-body=true, timeout=15, tag=Sniffer · offerings · resp

# ===== 降噪：把明显无关的上报静音（可选）=====
# 想要极简日志可以解注释
# ^https?:\/\/[^\/]+\/(analytics|track|tracking|metrics|log|events?)(\/|(\?.*)?$) url reject-200
